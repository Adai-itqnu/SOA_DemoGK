<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Qu·∫£n l√Ω s√°ch</title>
    <style>
      body {
        font-family: "Segoe UI", Arial, sans-serif;
        background: #f4f6f8;
        margin: 0;
        padding: 0;
      }

      header {
        background: linear-gradient(135deg, #007bff, #00c3ff);
        color: white;
        padding: 15px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      header h2 {
        margin: 0;
      }

      header .btn {
        background: #dc3545;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
      }

      header .btn:hover {
        background: #b02a37;
      }

      main {
        width: 90%;
        max-width: 1100px;
        margin: 30px auto;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        padding: 20px 30px;
      }

      h3 {
        text-align: center;
        color: #333;
        margin-bottom: 25px;
      }

      form {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 25px;
      }

      form input {
        flex: 1;
        min-width: 150px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 14px;
      }

      form button {
        background: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 10px 20px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
      }

      form button:hover {
        background: #0056b3;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 12px;
        text-align: center;
        border-bottom: 1px solid #ddd;
      }

      th {
        background: #007bff;
        color: white;
      }

      tr:hover {
        background: #f1f7ff;
      }

      button.action {
        background: #28a745;
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.3s;
      }

      button.action:hover {
        background: #1e7e34;
      }

      button.delete {
        background: #dc3545;
      }

      button.delete:hover {
        background: #b02a37;
      }

      .back-btn {
        background: #6c757d;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 10px 16px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
        text-decoration: none;
      }

      .back-btn:hover {
        background: #5a6268;
      }

      footer {
        text-align: center;
        color: #777;
        margin-top: 40px;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <h2>üìö Xin ch√†o, Admin {{ admin }} üëë</h2>
      <div>
        <a href="/logout"><button class="btn">ƒêƒÉng xu·∫•t</button></a>
      </div>
    </header>

    <!-- Main -->
    <main>
      <h3>üìñ Danh s√°ch s√°ch trong th∆∞ vi·ªán</h3>

      <!-- Form th√™m s√°ch -->
      <form onsubmit="return addBook(event)">
        <input id="id" type="number" placeholder="ID" required />
        <input id="title" type="text" placeholder="Ti√™u ƒë·ªÅ" required />
        <input id="author" type="text" placeholder="T√°c gi·∫£" required />
        <input id="category" type="text" placeholder="Th·ªÉ lo·∫°i" />
        <input id="quantity" type="number" placeholder="S·ªë l∆∞·ª£ng" required />
        <button type="submit">‚ûï Th√™m</button>
      </form>

      <!-- B·∫£ng -->
      <table>
        <tr>
          <th>ID</th>
          <th>Ti√™u ƒë·ªÅ</th>
          <th>T√°c gi·∫£</th>
          <th>Th·ªÉ lo·∫°i</th>
          <th>S·ªë l∆∞·ª£ng</th>
          <th>C·∫≠p nh·∫≠t</th>
          <th>X√≥a</th>
        </tr>
        {% for b in books %}
        <tr>
          <td>{{ b.id }}</td>
          <td>
            <input type="text" id="title_{{ b.id }}" value="{{ b.title }}" />
          </td>
          <td>
            <input type="text" id="author_{{ b.id }}" value="{{ b.author }}" />
          </td>
          <td>
            <input
              type="text"
              id="category_{{ b.id }}"
              value="{{ b.category }}"
            />
          </td>
          <td>
            <input
              type="number"
              id="quantity_{{ b.id }}"
              value="{{ b.quantity }}"
            />
          </td>
          <td>
            <button class="action" onclick="updateBook('{{ b.id }}')">
              üíæ L∆∞u
            </button>
          </td>
          <td>
            <button class="action delete" onclick="deleteBook('{{ b.id }}')">
              üóëÔ∏è X√≥a
            </button>
          </td>
        </tr>
        {% endfor %}
      </table>
    </main>

    <footer>¬© 2025 H·ªá th·ªëng qu·∫£n l√Ω s√°ch | SOA Flask + MongoDB</footer>

    <!-- Script -->
    <script>
      async function addBook(e) {
        e.preventDefault();
        const data = {
          id: parseInt(document.getElementById("id").value),
          title: document.getElementById("title").value,
          author: document.getElementById("author").value,
          category: document.getElementById("category").value,
          quantity: parseInt(document.getElementById("quantity").value),
        };
        await fetch("/books", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });
        location.reload();
      }

      async function updateBook(id) {
        const data = {
          title: document.getElementById(`title_${id}`).value,
          author: document.getElementById(`author_${id}`).value,
          category: document.getElementById(`category_${id}`).value,
          quantity: parseInt(document.getElementById(`quantity_${id}`).value),
        };
        await fetch(`/books/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });
        location.reload();
      }

      async function deleteBook(id) {
        if (!confirm("B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a s√°ch n√†y?")) return;
        await fetch(`/books/${id}`, { method: "DELETE" });
        location.reload();
      }
    </script>
  </body>
</html>
